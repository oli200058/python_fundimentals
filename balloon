import turtle
import random
import time

sc=turtle.Screen()
sc.bgcolor("sky blue")
sc.setup(800,700)
sc.tracer(0)

p=turtle.Turtle()
p.shape("triangle")
p.color("red")
p.penup()
p.goto(0,-320)
#score
score=0
score_display=turtle.Turtle()
score_display.hideturtle()
score_display.penup()
score_display.goto(-350,300)
score_display.color("red")
score_display.write(f'score: {score}',font=("Arial",16,"normal"))

#balloons
balloons=[]
game_speed=0.02
difficulty_inc=0.001
spawn_interval=2
last_spawn_time=time.time()
running=True

def move_left():
    x=p.xcor()-30
    if x  > -390:
        p.setx(x)


def move_right():
    x=p.xcor()+30
    if x  < 390:
        p.setx(x)


def spawn_balloons():
    balloon=turtle.Turtle()
    balloon.penup()
    balloon.shape("circle")
    balloon_color=["red","blue","yellow","green","purple","orange"]
    balloon.color(random.choice(balloon_color))
    balloon.goto(random.randint(-350,350),random.randint(200,300))
    balloon.speed(random.uniform(1,5))
    if random.randint()<0.2:
        balloon.color("black")
        balloon.is_bomb=True
    else:
        balloon.is_bomb=False

    balloons.append(balloon)

def update_score(points):
    global score
    score += points
    score_display.clear()
    score_display.write(f'score: {score}',font=("Arial",16,"normal"))


def game_over():
    global running
    running = False
    game_over_display=turtle.Turtle()
    game_over_display.hideturtle()
    game_over_display.color("red")
    game_over_display.write("GAME OVER", align="center", font=("arial",36,"bold"))
    sc.update()
    time.sleep(2)
    sc.bye()

    #keybinds
    sc.listen()
    sc.onkey(move_left,"Left")
    sc.onkey(move_right,"Right")

    #game loop

    sc.update()
    current_time=time.time()
    if current_time-last_spawn_time>spawn_interval:
        spawn_balloons()
        last_spawn_time=current_time
    
    for balloon in balloon[:]:
        balloon.sety(balloon.ycor()-balloon.speed)
        balloon.remove(balloon)
        balloon.hideturtle()

        if p.distance(balloon)<30:
            if balloon.is_bomb:
                game_over()
            else:
                update_score(10)

            balloon.remove(balloons)
            balloon.hideturtle()
    game_speed=max(0.005,game_speed-difficulty_inc)
    spawn_interval=max(0.5,spawn_interval-0.0005)
    time.sleep(game_speed)


        















sc.mainloop()
